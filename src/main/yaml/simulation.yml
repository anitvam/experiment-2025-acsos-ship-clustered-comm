environment:
  type: NavigationEnvironment
  parameters:
    - ["maps/north_germany_coastline.geojson"]
 #   - ["maps/north_germany_waterways.geojson", "maps/north_germany_waterways3.geojson"]

incarnation: collektive

network-model:
  type: ConnectWithinDistance
  parameters: [15000]

_pool: &program
  - time-distribution: 0.1
    type: Event
    actions:
      - type: RunCollektiveProgram
        parameters: [it.unibo.collektive.examples.gradient.GradientKt.gradientEntrypoint]

_pools:
  - pool: &move
      - time-distribution: 0.1
        type: Event
        actions:
          - type: ReproduceGPSTrace
            parameters:
              path: "navigation-routes"
              cycle: false
              normalizer: "AlignToSimulationTime"
              normalizerArgs: []
      - time-distribution:
          type: Trigger
          parameters: [ 0 ]
        type: Event
        actions:
          - type: LoadIdFromTrace
            parameters: [ "navigation-routes" ]
deployments:
  - type: FromGPSTraceCustom
    parameters:
      path: "navigation-routes" # Folder containing GPS traces
      normalizer: "AlignToSimulationTime"
      normalizerArgs: []
    programs:
      - *move
      - *program
    contents:
      - molecule: source
        concentration: false
  - type: Point
    parameters: [54.427794, 10.313027]
    programs:
      - *program
    contents:
      - molecule: source
        concentration: true
      - molecule: station
        concentration: true
terminate:
  type: StableForSteps
  parameters:
    equalIntervals: 5
    checkInterval: 100
