environment:
  type: NavigationEnvironment
  parameters:
    - ["maps/north_germany_coastline.geojson"]
 #   - ["maps/north_germany_waterways.geojson", "maps/north_germany_waterways3.geojson"]

incarnation: collektive

network-model:
  type: ConnectWithinDistance
  parameters: [15000]

_pool: &program
  - time-distribution: 0.1
    type: Event
    actions:
      - type: RunCollektiveProgram
        parameters: [it.unibo.collektive.examples.gradient.GradientKt.gradientEntrypoint]

_pools:
  - pool: &move
      - time-distribution: 0.1
        type: Event
        actions:
          - type: ReproduceGPSTrace
            parameters:
              path: "navigation-routes"
              cycle: false
              normalizer: "AlignToSimulationTime"
              normalizerArgs: []
      - time-distribution:
          type: Trigger
          parameters: [ 0 ]
        type: Event
        actions:
          - type: LoadIdFromTrace
            parameters: [ "navigation-routes" ]
deployments:
  - type: FromGPSTraceCustom
    parameters:
      path: "navigation-routes" # Folder containing GPS traces
      normalizer: "AlignToSimulationTime"
      normalizerArgs: []
    programs:
      - *move
      - *program
    contents:
      - molecule: source
        concentration: false
  - type: SpecificPositions
    parameters:
      - [ 54.26, 9.63 ] # Rendsburg, Germany
      - [ 54.36, 10.07 ] # Kiel-Suchsdorf, Germany
      - [ 54.33, 10.08 ] # Kiel-2, Germany
      - [ 54.37, 10.12 ] # Kiel, Germany
      - [ 54.39, 10.18 ] # Friedrichsort, Germany
      - [ 54.81, 11.14 ] # Island Brigge, Denmark
    programs:
      - *program
    contents:
      - molecule: source
        concentration: true
      - molecule: station
        concentration: true
terminate:
  type: StableForSteps
  parameters:
    equalIntervals: 5
    checkInterval: 100
